---
title: "Willamette Falls Fish Passage"
author:
  - name: Conner Jainese 
    url: {}
date: 2022-03-10
output: 
  distill::distill_article:
    self_contained: false
---

```{r setup, include = TRUE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
# load packages
library(tidyverse)
library(here)
library(janitor)
library(lubridate)
library(tsibble)
library(ggdark)
library(feasts)
```

```{r fig.align='center'}
# add salmon pic
knitr::include_graphics(here("pics", "chinook_pic.jpg"))
```

**Figure 1.** Chinook salmon (*Oncorhynchus tshawytscha*) swimming upstream to spawn^1^. This is but one of the salmonid species commonly observed at the Willamette Falls fish passage. 

## Overview

In this report, we will be exploring the Willamette Falls fish passage data for adult salmonids observed swimming upstream between 1/1/2001 and 12/31/2010. This data is collected by the Oregon Department of Fish and Wildlife, and is made available through Columbia River DART (Data Access Real Time)^2^. Adult fish passage data is used to monitor and assess salmonid stock health for real time management. We will be conducting a 3-part time series analysis on this dataset.    
```{r fig.align="center"}
# add map
knitr::include_graphics(here("pics", "willamette_falls_map.png"))
```

**Figure 2.** Map of the Willamette River Basin in Oregon, with the Willamette Falls fish passage labeled at the northern part of the basin^3^. 

## Time Series Analyses {.tabset .tabset-fade}

```{r}
# read in fish data and clean up names 
fish_dat <- read_csv(here("data", "willamette_fish_passage.csv")) %>% 
  clean_names()
```

### Original Time Series

```{r fig.align='center'}
# wrangle the data a bit 
fish_og <- fish_dat %>%
  # select variables we want
  select(date, coho, jack_coho, steelhead) %>% 
  # replace na with 0
  replace_na(list(coho = 0, jack_coho = 0, steelhead = 0)) %>% 
  # change date to date format 
  mutate(date = mdy(date)) %>% 
  # pivot for tsibble
  pivot_longer(c(coho:steelhead), names_to = "species", 
               values_to = "count") %>% 
  # make tsibble
  as_tsibble(key = species, index = date) %>% 
  # replace values to look better in figure 
  mutate(species = replace(species, species == "coho", "Coho")) %>% 
  mutate(species = replace(species, species == "jack_coho", "Jack Coho")) %>% 
  mutate(species = replace(species, species == "steelhead", "Steelhead"))

# plot
ggplot(data = fish_og, 
       aes(x = date, y = count)) +
  geom_line(aes(color = species)) +
  facet_grid(species~., scales = "free") +
  labs(x = "Year", 
       y = "Adult Salmonid Count", 
       title = "Adult Salmonid Counts at Willamette Falls") +
  dark_theme_gray() +
  theme(legend.position = "none")  +
  theme(plot.title = element_text(size = 16))

```

**Figure 3.** Daily fish counts at the Willamette Falls fish passage for three salmonids: Coho (*Oncorhynchus kisutch*), Jack Coho (*Oncorhynchus kisutch*), and Steelhead (*Oncorhynchus mykiss*). Data begins 1/1/2001 and ends 12/31/2010.

- The greatest similarities in timing of migration and duration of migration occur between Coho and Jack Coho salmon. This is consistent with what we might expect, since these are actually the same species, the only difference being that Jack Coho are one year younger than regular adult Coho.
- Steelhead have a noticeably wider time range for migration, spanning much of the first half of the year. Coho/Jack Coho have a very narrow range of migration that typically occurs in the latter half of the year. 
- There is a noticeable 1 year lag between peak Jack Coho migration and Coho peak migration. Since Jack Coho return to spawn 1 year earlier than normal, it is likely that the largest peaks for Coho/Jack Coho are actually fish from the same cohort. 

### Seasonplots

```{r fig.align='center'}
# wrangling data 
fish_season <- fish_og %>% 
  group_by(species) %>% 
  index_by(yr_mo = ~yearmonth(.)) %>% 
  summarise(mean = mean(count, na.rm = TRUE))

gg_season(data = fish_season, 
          y = mean) +
  dark_theme_gray() +
  labs(title = "Mean Monthly Salmonid Counts at Willamette Falls", 
       x = "Month", 
       y = "Mean Count")  +
  theme(plot.title = element_text(size = 16))
```

**Figure 4.** Mean monthly fish counts at the Willamette Falls fish passage for three salmonids: Coho (*Oncorhynchus kisutch*), Jack Coho (*Oncorhynchus kisutch*), and Steelhead (*Oncorhynchus mykiss*). Individual lines represent a single year of data. 

- Here we clearly see that Coho/Jack Coho migrate upstream during a relatively narrow period of time, between August and November.
- In contrast, peak Steelhead migration occurs between approximately February and July, with very low levels of migration occuring throughout the rest of the year.
- We also see that migrating Coho abundance increased dramatically in the most recent years of the study, compared to previous years. 

### Annual Counts by Species

```{r fig.align='center'}
# more data wrangling
fish_total <- fish_og %>%
  # group by species
  group_by(species) %>%
  # index by year 
  index_by(yr = ~year(.)) %>%
  # sum
  summarise(total_fish = sum(count)) %>%
  # make year column factor type 
  mutate(year = factor(yr))

ggplot(data = fish_total, 
       aes(y = total_fish, 
           x = year)) +
  geom_col(aes(fill = species)) +
  facet_grid(species~., 
             scales = "free") +
  dark_theme_gray() +
  labs(x = "Year", 
       y = "Total Count", 
       title = "Total Salmonid Counts Per Year at Willamette Falls") +
  theme(legend.position = "none") +
  theme(plot.title = element_text(size = 16))
```

**Figure 5.** Total annual fish counts at the Willamette Falls fish passage for three salmonids: Coho (*Oncorhynchus kisutch*), Jack Coho (*Oncorhynchus kisutch*), and Steelhead (*Oncorhynchus mykiss*).

- In this figure, we see that Steelhead make up a relatively large proportion of the number of fish migrating through Willamette Falls fish passage (peaking at approximately 50,000 individuals per year). 
- Generally, the abundance of migrating Coho/Jack Coho has increased over the course of this dataset, while Steelhead abundance has decreased. 
- We also see again, that peaks in Jack Coho precede peaks in regular adult Coho by one year, which is consistent with the biology/behavior of these two groups mentioned in the "Original Time Series" tab. 

## {-}

### Citations

^1^ Oregon Department of Fish and Wildlife, https://www.oregonconservationstrategy.org/strategy-species/chinook-salmon/chinook-salmon-spring-willamette-smu/

^2^ Oregon Department of Fish and Wildlife, Willamette Falls (Sullivan Project), http://www.cbr.washington.edu/dart/wrapper?type=html&fname=metainventory_WFF.html

^3^ Clemens, Benjamin, MG Mesa, Robert Magie, DA Young, and CB Schreck. “Pre-Spawning Migration of Adult Pacific Lamprey, Entosphenus Tridentatus, in the Willamette River, Oregon, USA.” Environmental Biology of Fishes 93 (January 1, 2012): 245–54.
